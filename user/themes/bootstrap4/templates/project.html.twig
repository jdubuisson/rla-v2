{% extends 'partials/base.html.twig' %}
{% import _self as macro %}

{% set show_onpage_menu = header.onpage_menu == true or header.onpage_menu is null %}
{% macro pageLinkName(text) %}{{ text|lower|replace({' ':'_'}) }}{% endmacro %}

{% block javascripts %}
    {{ parent() }}
{% endblock %}

{% block bottom %}
    {{ parent() }}
{% endblock %}

{% block body_classes %}{{ parent() }} {% endblock %}

{% block header_navigation %}
    {{ parent() }}
{% endblock %}

{% block content %}
    <div class="project container-fluid">
        <div class="row">
            <div class="col-md-12 col-lg-6 col-xl-8">
                <div id="carouselIndicators" class="carousel slide w-100 carousel-fade"
                     data-ride="carousel">
                    <div class="carousel-inner">
                        {% for image in page.media.images %}
                            <div class="carousel-item {% if loop.index0 == 0 %}active{% endif %}">
                                {{ image.cropZoom(1200, 900).html(page.title, page.title)|raw }}
                            </div>
                        {% endfor %}
                    </div>
                    <a class="carousel-control-prev" href="#carouselIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                    <ol class="carousel-indicators d-none d-sm-flex">
                        {% for image in page.media.images %}
                            <li data-target="#carouselIndicators" data-slide-to="{{ loop.index0 }}">
                                {{ image.cropZoom(120, 90).html(page.title, page.title)|raw }}
                            </li>
                        {% endfor %}
                    </ol>
                </div>
            </div>
            <div class="col-md-12 col-lg-6 col-xl-4 pt-3">
                {{ page.content|raw }}
                <div class="d-none d-sm-block">
                    <h4>Autres r√©alisations</h4>
                    <div class="row other-projects">
                        {% set siblings = page.collection({ items: '@self.siblings'}) %}
                        {% for sibling in siblings|slice(0, 3) %}
                            <div class="col-4">
                                {% set sibling_image = sibling.header.header_image|defined(true) %}
                                {% set sibling_image_file = sibling.header.header_image_file %}
                                <a href="{{ sibling.url }}">
                                    {% if sibling_image %}
                                        {% if sibling_image_file %}
                                            {% set sibling_image_media = page.media.images[sibling_image_file] %}
                                        {% else %}
                                            {% set sibling_image_media = page.media.images|first %}
                                        {% endif %}
                                        {{ sibling_image_media.cropZoom(240, 180).html(sibling.title, sibling.title)|raw }}
                                    {% endif %}
                                    <span>{{ sibling.title|truncate(50) }}</span>
                                </a>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
